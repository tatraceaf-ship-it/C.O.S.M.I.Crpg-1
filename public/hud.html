<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();

// pega o id do hud pela URL
const params = new URLSearchParams(window.location.search);
const hudId = params.get("hud") || "leafone";

// entra na sala correta
socket.emit("join", hudId);

const vidaFill = document.getElementById("vidaFill");
const vidaBar = document.getElementById("vidaBar");
const vidaText = document.getElementById("vidaText");
const manaText = document.getElementById("manaText");
const diceContainer = document.getElementById("diceContainer");

socket.on("hudUpdate", s => {
  document.getElementById("name").innerText = s.name;
  document.getElementById("levelHud").innerText = s.level;

  vidaText.innerText = `${s.vidaAtual}/${s.vidaMax}`;
  manaText.innerText = `${s.manaAtual}/${s.manaMax}`;

  vidaBar.style.display = s.showVidaBar ? "block" : "none";
  vidaFill.style.width = `${(s.vidaAtual / s.vidaMax) * 100}%`;

  diceContainer.innerHTML = "";
  if (s.dice && s.dice.rolls) {
    s.dice.rolls.forEach(v => {
      const d = document.createElement("div");
      d.className = "diceHex";
      d.textContent = v;
      diceContainer.appendChild(d);
    });
  }
});
</script>
